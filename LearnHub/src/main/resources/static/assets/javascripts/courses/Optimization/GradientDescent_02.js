import{n as x,s as q}from"../assets/math-vsX8GA3L.js";import{c as F,a as P}from"../assets/_commonjsHelpers-C4iS2aBk.js";import{d as X}from"../assets/draw-NCLF76eS.js";function k(n){return n.reduce((e,r)=>e+r,0)}function I(n){return n.reduce((e,r)=>e*r,1)}function v(n){return e=>e?0:n}function z(n,e){return r=>r?(r==null?void 0:r[n])??0:e}function g(n,e){return r=>n*(r?e(r):e())}function h(...n){return e=>k(n.map(r=>e?r(e):r()))}function w(...n){return e=>e?k(n.map((r,c)=>I(n.map((t,o)=>c==o?t(e):t())))):I(n.map(r=>r()))}var R={exports:{}};(function(n,e){(function(r,c){n.exports=c()})(F,function(){return r.importState=function(t){var o=new r;return o.importState(t),o},r;function r(){return function(t){var o=0,i=0,u=0,l=1;t.length==0&&(t=[+new Date]);var m=c();o=m(" "),i=m(" "),u=m(" ");for(var d=0;d<t.length;d++)o-=m(t[d]),o<0&&(o+=1),i-=m(t[d]),i<0&&(i+=1),u-=m(t[d]),u<0&&(u+=1);m=null;var a=function(){var f=2091639*o+l*23283064365386963e-26;return o=i,i=u,u=f-(l=f|0)};return a.next=a,a.uint32=function(){return a()*4294967296},a.fract53=function(){return a()+(a()*2097152|0)*11102230246251565e-32},a.version="Alea 0.9",a.args=t,a.exportState=function(){return[o,i,u,l]},a.importState=function(f){o=+f[0]||0,i=+f[1]||0,u=+f[2]||0,l=+f[3]||0},a}(Array.prototype.slice.call(arguments))}function c(){var t=4022871197,o=function(i){i=i.toString();for(var u=0;u<i.length;u++){t+=i.charCodeAt(u);var l=.02519603282416938*t;t=l>>>0,l-=t,l*=t,t=l>>>0,l-=t,t+=l*4294967296}return(t>>>0)*23283064365386963e-26};return o.version="Mash 0.9",o}})})(R);var Y=R.exports;const j=P(Y),G="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let O=(n=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(n));for(;n--;)e+=G[r[n]&63];return e};function L(n){return w(n,n,h(v(3),g(-2,n)))}function b(n,e,r){return h(w(r,e),w(h(v(1),g(-1,r)),n))}function N(){const n=O();return(e,r)=>{const c=Math.floor(e()),t=Math.floor(r()),o=L(h(e,v(-c))),i=L(h(r,v(-t)));function u(l,m){const d=new j([n,l,m]),a=2*Math.PI*d();return h(g(Math.cos(a),h(e,v(-l))),g(Math.sin(a),h(r,v(-m))))}return b(b(u(c,t),u(c+1,t),o),b(u(c,t+1),u(c+1,t+1),o),i)}}function T(n=2,e=1.5){const r=[...Array(n)].map((c,t)=>{const o=N();return(i,u)=>{const l=e**t;return g(1/l,o(g(l,i),g(l,u)))}});return(c,t)=>h(...r.map(o=>o(c,t)))}const A=1;function U(n,e){const r=V();return{noise:r,map:W(n,e,r),attempts:[],x:Math.random(),y:Math.random(),result:null,particles:[]}}function V(){function n(r){return g(2*A,h(r,v(-.5)))}const e=T();return(r,c)=>{const t=e(n(z("x",r)),n(z("y",c)));return(o,i)=>o!==void 0?t({x:o,y:i}):t()}}function W(n,e,r){const c=document.createElement("canvas"),t=c.getContext("2d"),o=t.createImageData(n,e);c.width=n,c.height=e;for(let i=0;i<e;i++)for(let u=0;u<n;u++){const l=Math.floor(256*M(r(u/n,i/e)()));o.data[4*(n*i+u)]=l,o.data[4*(n*i+u)+1]=0,o.data[4*(n*i+u)+2]=255-l,o.data[4*(n*i+u)+3]=255}return t.putImageData(o,0,0),c}function M(n){return q(5*n)}document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("mana-descent"),e=n.getContext("2d"),r=document.getElementById("confirm"),c=document.getElementById("restart");let t=null,o=!1,i=null;function u(a,f){t.result||(t.x=a/n.width,t.y=f/n.height,d())}function l(){if(t.result)return;if(t.attempts.length==10){t.result=[t.x,t.y,t.noise(t.x,t.y)()];return}const a=t.noise(t.x,t.y),f=a(),p=a(1,0),s=a(0,1);t.attempts.push([t.x,t.y,f,p,s]);for(let y=0;y<16;y++)t.particles.push({life:3+x()/3,time:0,x:t.x,y:t.y,vy:x()/400,vx:x()/400,ax:(-p+x()*2/3)/200,ay:(-s+x()*2/3)/200,z:f});r.textContent=t.attempts.length==10?"여기로 결정":`${t.attempts.length+1}개째 터뜨리기`,d()}function m(){t=U(n.width,n.height),r.textContent="1개째 터뜨리기",d()}function d(){o=!0}requestAnimationFrame(function a(f){const p=i===null?0:(f-i)/1e3;if(i=f,o){o=t.particles.length!=0,e.clearRect(0,0,n.width,n.height),t.result&&(e.globalAlpha=.3,e.drawImage(t.map,0,0),e.globalAlpha=1),t.particles=t.particles.filter(s=>(s.time+=p)<s.life);for(const s of t.particles){const y=Math.floor(256*M(s.z));s.x+=p*(s.vx+=p*s.ax),s.y+=p*(s.vy+=p*s.ay),e.fillStyle=`rgba(${y}, 0, ${255-y}, ${1-s.time/s.life})`,e.fillRect(Math.round(n.width*s.x)-2,Math.round(n.height*s.y)-2,4,4)}e.lineWidth=2;for(let s=0;s<t.attempts.length;s++){const[y,B,D,_,$]=t.attempts[s],E=Math.floor(256*M(D)),C=n.width*y,S=n.height*B;e.globalAlpha=t.result||s==t.attempts.length-1?1:.5,e.fillStyle=e.strokeStyle=`rgba(${E}, 0, ${255-E})`,X(e,C,S,C-10/A*_,S-10/A*$,10)}e.globalAlpha=1,e.strokeStyle="black",e.beginPath(),e.arc(n.width*t.x,n.height*t.y,8,0,2*Math.PI),e.stroke()}requestAnimationFrame(a)}),n.addEventListener("mousedown",a=>{if(!(a.buttons&1))return;const{left:f,top:p}=a.target.getBoundingClientRect();u(a.clientX-f,a.clientY-p)}),n.addEventListener("mousemove",a=>{if(!(a.buttons&1))return;const{left:f,top:p}=a.target.getBoundingClientRect();u(a.clientX-f,a.clientY-p)}),r.addEventListener("click",l),c.addEventListener("click",m),setTimeout(m,0)});
import{a as Tt}from"../assets/_commonjsHelpers-C4iS2aBk.js";import{a as $}from"../assets/draw-NCLF76eS.js";import{l as ct}from"../assets/math-vsX8GA3L.js";function z(R){if(this.size=R|0,this.size<=1||this.size&this.size-1)throw new Error("FFT size must be a power of two and bigger than 1");this._csize=R<<1;for(var t=new Array(this.size*2),e=0;e<t.length;e+=2){const w=Math.PI*e/this.size;t[e]=Math.cos(w),t[e+1]=-Math.sin(w)}this.table=t;for(var c=0,n=1;this.size>n;n<<=1)c++;this._width=c%2===0?c-1:c,this._bitrev=new Array(1<<this._width);for(var a=0;a<this._bitrev.length;a++){this._bitrev[a]=0;for(var s=0;s<this._width;s+=2){var i=this._width-s-2;this._bitrev[a]|=(a>>>s&3)<<i}}this._out=null,this._data=null,this._inv=0}var Mt=z;z.prototype.fromComplexArray=function(t,e){for(var c=e||new Array(t.length>>>1),n=0;n<t.length;n+=2)c[n>>>1]=t[n];return c};z.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t};z.prototype.toComplexArray=function(t,e){for(var c=e||this.createComplexArray(),n=0;n<c.length;n+=2)c[n]=t[n>>>1],c[n+1]=0;return c};z.prototype.completeSpectrum=function(t){for(var e=this._csize,c=e>>>1,n=2;n<c;n+=2)t[e-n]=t[n],t[e-n+1]=-t[n+1]};z.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null};z.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null};z.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var c=0;c<t.length;c++)t[c]/=this.size;this._out=null,this._data=null};z.prototype._transform4=function(){var t=this._out,e=this._csize,c=this._width,n=1<<c,a=e/n<<1,s,i,w=this._bitrev;if(a===4)for(s=0,i=0;s<e;s+=a,i++){const d=w[i];this._singleTransform2(s,d,n)}else for(s=0,i=0;s<e;s+=a,i++){const d=w[i];this._singleTransform4(s,d,n)}var m=this._inv?-1:1,y=this.table;for(n>>=2;n>=2;n>>=2){a=e/n<<1;var b=a>>>2;for(s=0;s<e;s+=a)for(var T=s+b,C=s,l=0;C<T;C+=2,l+=n){const d=C,M=d+b,I=M+b,D=I+b,S=t[d],P=t[d+1],r=t[M],o=t[M+1],p=t[I],_=t[I+1],g=t[D],A=t[D+1],f=S,u=P,h=y[l],v=m*y[l+1],E=r*h-o*v,F=r*v+o*h,Y=y[2*l],k=m*y[2*l+1],H=p*Y-_*k,B=p*k+_*Y,G=y[3*l],X=m*y[3*l+1],J=g*G-A*X,K=g*X+A*G,Q=f+H,x=u+B,N=f-H,Z=u-B,L=E+J,U=F+K,V=m*(E-J),q=m*(F-K),j=Q+L,tt=x+U,nt=Q-L,et=x-U,rt=N+q,st=Z-V,ot=N-q,it=Z+V;t[d]=j,t[d+1]=tt,t[M]=rt,t[M+1]=st,t[I]=nt,t[I+1]=et,t[D]=ot,t[D+1]=it}}};z.prototype._singleTransform2=function(t,e,c){const n=this._out,a=this._data,s=a[e],i=a[e+1],w=a[e+c],m=a[e+c+1],y=s+w,b=i+m,T=s-w,C=i-m;n[t]=y,n[t+1]=b,n[t+2]=T,n[t+3]=C};z.prototype._singleTransform4=function(t,e,c){const n=this._out,a=this._data,s=this._inv?-1:1,i=c*2,w=c*3,m=a[e],y=a[e+1],b=a[e+c],T=a[e+c+1],C=a[e+i],l=a[e+i+1],d=a[e+w],M=a[e+w+1],I=m+C,D=y+l,S=m-C,P=y-l,r=b+d,o=T+M,p=s*(b-d),_=s*(T-M),g=I+r,A=D+o,f=S+_,u=P-p,h=I-r,v=D-o,E=S-_,F=P+p;n[t]=g,n[t+1]=A,n[t+2]=f,n[t+3]=u,n[t+4]=h,n[t+5]=v,n[t+6]=E,n[t+7]=F};z.prototype._realTransform4=function(){var t=this._out,e=this._csize,c=this._width,n=1<<c,a=e/n<<1,s,i,w=this._bitrev;if(a===4)for(s=0,i=0;s<e;s+=a,i++){const at=w[i];this._singleRealTransform2(s,at>>>1,n>>>1)}else for(s=0,i=0;s<e;s+=a,i++){const at=w[i];this._singleRealTransform4(s,at>>>1,n>>>1)}var m=this._inv?-1:1,y=this.table;for(n>>=2;n>=2;n>>=2){a=e/n<<1;var b=a>>>1,T=b>>>1,C=T>>>1;for(s=0;s<e;s+=a)for(var l=0,d=0;l<=C;l+=2,d+=n){var M=s+l,I=M+T,D=I+T,S=D+T,P=t[M],r=t[M+1],o=t[I],p=t[I+1],_=t[D],g=t[D+1],A=t[S],f=t[S+1],u=P,h=r,v=y[d],E=m*y[d+1],F=o*v-p*E,Y=o*E+p*v,k=y[2*d],H=m*y[2*d+1],B=_*k-g*H,G=_*H+g*k,X=y[3*d],J=m*y[3*d+1],K=A*X-f*J,Q=A*J+f*X,x=u+B,N=h+G,Z=u-B,L=h-G,U=F+K,V=Y+Q,q=m*(F-K),j=m*(Y-Q),tt=x+U,nt=N+V,et=Z+j,rt=L-q;if(t[M]=tt,t[M+1]=nt,t[I]=et,t[I+1]=rt,l===0){var st=x-U,ot=N-V;t[D]=st,t[D+1]=ot;continue}if(l!==C){var it=Z,dt=-L,ut=x,mt=-N,pt=-m*j,gt=-m*q,_t=-m*V,ft=-m*U,yt=it+pt,wt=dt+gt,bt=ut+ft,Ft=mt-_t,lt=s+T-l,ht=s+b-l;t[lt]=yt,t[lt+1]=wt,t[ht]=bt,t[ht+1]=Ft}}}};z.prototype._singleRealTransform2=function(t,e,c){const n=this._out,a=this._data,s=a[e],i=a[e+c],w=s+i,m=s-i;n[t]=w,n[t+1]=0,n[t+2]=m,n[t+3]=0};z.prototype._singleRealTransform4=function(t,e,c){const n=this._out,a=this._data,s=this._inv?-1:1,i=c*2,w=c*3,m=a[e],y=a[e+c],b=a[e+i],T=a[e+w],C=m+b,l=m-b,d=y+T,M=s*(y-T),I=C+d,D=l,S=-M,P=C-d,r=l,o=M;n[t]=I,n[t+1]=0,n[t+2]=D,n[t+3]=S,n[t+4]=P,n[t+5]=0,n[t+6]=r,n[t+7]=o};const At=Tt(Mt),W=2*Math.PI,vt=new At(256);function O(){return 1-Math.floor(41*Math.random())/20}document.addEventListener("DOMContentLoaded",()=>{const R=[document.getElementById("fourier-practice-1"),document.getElementById("fourier-practice-2"),document.getElementById("fourier-practice-3")],t=R.map(r=>r.getContext("2d")),e=document.getElementById("fourier-practice-sum"),c=e.getContext("2d"),n=document.getElementById("fourier-demo-input"),a=n.getContext("2d"),s=document.getElementById("fourier-demo-output"),i=s.getContext("2d"),w=[document.getElementById("slider-practice-1"),document.getElementById("slider-practice-2"),document.getElementById("slider-practice-3")],m=document.getElementById("retry-practice"),y=document.getElementById("run-demo"),b=n.height/2,T=s.height/b;let C,l;const d=[...Array(256)].map((r,o)=>Math.sin(W*o/256));function M(){C=[O(),O(),O()];for(const r of w)r.value=O();I()}function I(){const r=w.map(o=>o.valueAsNumber);for(let o=0;o<3;o++)t[o].clearRect(0,0,R[o].width,R[o].height),t[o].strokeStyle="blue",t[o].lineWidth=3,$(t[o],p=>r[o]*Math.sin((o+1)*W*p),0,1,-3,3);c.clearRect(0,0,e.width,e.height),c.strokeStyle="red",c.lineWidth=1,$(c,o=>C[0]*Math.sin(1*W*o)+C[1]*Math.sin(2*W*o)+C[2]*Math.sin(3*W*o),0,1,-3,3),c.strokeStyle="blue",c.lineWidth=3,$(c,o=>r[0]*Math.sin(1*W*o)+r[1]*Math.sin(2*W*o)+r[2]*Math.sin(3*W*o),0,1,-3,3)}function D(r,o,p,_){if(r=Math.round(r),o=Math.round(o),r==o)0<=r&&r<256&&(d[r]=p/b-1);else{if(r>o){const g=r;r=o,o=g;const A=p;p=_,_=A}for(let g=Math.max(r,0);g<=o&&g<256;g++){const A=p+(g-r)/(o-r)*(_-p);d[g]=A/b-1}}S()}function S(){a.clearRect(0,0,n.width,n.height),a.strokeStyle="black",a.lineWidth=3,$(a,r=>d[Math.floor((r%256+256)%256)],0,256,-1,1)}function P(){const r=Math.max(...d),o=Math.min(...d),p=d.reduce((h,v)=>h+v,0)/256,_=vt.createComplexArray();vt.realTransform(_,d);const g=[...Array(128)].map((h,v)=>{const E=(v==127?_[2*(v+1)]:2*_[2*(v+1)])/256,F=(v==127?_[2*(v+1)+1]:2*_[2*(v+1)+1])/256;return[v+1,E,F,Math.hypot(E,F)]}).sort((h,v)=>v[3]-h[3]).filter((h,v)=>v==0||h[3]>=.005),A=s.height/b;l={initial:d.map(h=>h-p),initialY:(r-p)*b,sines:[],timestamp:Date.now()};let f=r-o+.05,u=l.initial;for(const[h,v,E,F]of g)if(u=u.map((Y,k)=>Y-v*Math.cos(h*W*k/256)+E*Math.sin(h*W*k/256)),l.sines.push({index:h,re:v,im:E,magnitude:F,y:(f+F)*b,residual:u}),f+=2*F+.05,f>=A)break}for(const r of w)r.addEventListener("input",I);m.addEventListener("click",M),n.addEventListener("mousedown",r=>{if(!(r.buttons&1))return;const{left:o,top:p}=r.target.getBoundingClientRect(),_=r.clientX-o,g=r.clientY-p;D(_,_,n.height-g,n.height-g)}),n.addEventListener("mousemove",r=>{if(!(r.buttons&1))return;const{left:o,top:p}=r.target.getBoundingClientRect(),_=r.clientX-o,g=r.clientY-p;D(_-r.movementX,_,n.height-(g-r.movementY),n.height-g)}),y.addEventListener("click",P),M(),S(),P(),l.timestamp=0,requestAnimationFrame(function r(){function o(f,u,h,v){const E=T*(v/s.height-1);$(i,F=>u*Math.cos(f*W*F)-h*Math.sin(f*W*F),g,1+g,E,E+T)}function p(f,u){const h=T*(u/s.height-1);$(i,v=>f[Math.floor((v%256+256)%256)],256*g,256+256*g,h,h+T)}const _=Date.now(),g=_%4e3/4e3,A=(_-l.timestamp)/2e3;i.clearRect(0,0,s.width,s.height),i.strokeStyle="black",i.lineWidth=3,p(l.initial,l.initialY),i.strokeStyle="blue";for(let f=0;f<Math.round(A)&&f<l.sines.length;f++){const{index:u,re:h,im:v,magnitude:E,y:F}=l.sines[f];i.lineWidth=3*Math.sqrt(E),o(u,h,v,F)}if(A<l.sines.length){const f=A%1,u=Math.floor(A),h=l.sines[u],v=u==0?l.initial:l.sines[u-1].residual,E=h.residual,F=u==0?l.initialY:l.sines[u-1].y,Y=h.y,k=3*Math.sqrt(u==0?1:l.sines[u-1].magnitude),H=3*Math.sqrt(h.magnitude);if(f<.5){const B=1-(2*f-1)**2,G=ct(F,Y,B);i.strokeStyle="blue",i.lineWidth=H,i.globalAlpha=B,o(h.index,h.re,h.im,G),i.globalAlpha=1,i.strokeStyle="black",i.lineWidth=k,p(v,G)}else{const B=1-(2*f-2)**2;i.strokeStyle="blue",i.lineWidth=H,i.globalAlpha=1-B,o(h.index,(1-B)*h.re,(1-B)*h.im,h.y),i.globalAlpha=1,i.strokeStyle="black",i.lineWidth=ct(k,H,B),p([...Array(256)].map((G,X)=>ct(v[X],E[X],B)),h.y)}}else if(A<l.sines.length+.5){const f=2*(A-l.sines.length),u=l.sines[l.sines.length-1];i.strokeStyle="black",i.lineWidth=3*Math.sqrt(u.magnitude),i.globalAlpha=1-f,p(u.residual,u.y),i.globalAlpha=1}requestAnimationFrame(r)})});

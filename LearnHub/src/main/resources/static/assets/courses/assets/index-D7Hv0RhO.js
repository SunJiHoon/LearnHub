import{R as Je,P as $e,E as et,V as b,M as J,T as $,Q as Ne,S as ze,a as O,b as tt,W as ot,c as nt,d as at,A as it,D as st,B as rt,e as be,f as Ee,g as ue,h as we,i as G,j as Te,C as ct}from"./three.module-C7UIBytJ.js";const Fe={type:"change"},Pe={type:"start"},Ye={type:"end"},de=new Je,ve=new $e,lt=Math.cos(70*tt.DEG2RAD);class ut extends et{constructor(j,h){super(),this.object=j,this.domElement=h,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new b,this.cursor=new b,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:J.ROTATE,MIDDLE:J.DOLLY,RIGHT:J.PAN},this.touches={ONE:$.ROTATE,TWO:$.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return p.phi},this.getAzimuthalAngle=function(){return p.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",ge),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ge),this._domElementKeyEvents=null},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(Fe),e.update(),d=c.NONE},this.update=function(){const t=new b,o=new Ne().setFromUnitVectors(j.up,new b(0,1,0)),i=o.clone().invert(),m=new b,g=new Ne,H=new b,w=2*Math.PI;return function(Qe=null){const Se=e.object.position;t.copy(Se).sub(e.target),t.applyQuaternion(o),p.setFromVector3(t),e.autoRotate&&d===c.NONE&&M(S(Qe)),e.enableDamping?(p.theta+=T.theta*e.dampingFactor,p.phi+=T.phi*e.dampingFactor):(p.theta+=T.theta,p.phi+=T.phi);let C=e.minAzimuthAngle,N=e.maxAzimuthAngle;isFinite(C)&&isFinite(N)&&(C<-Math.PI?C+=w:C>Math.PI&&(C-=w),N<-Math.PI?N+=w:N>Math.PI&&(N-=w),C<=N?p.theta=Math.max(C,Math.min(N,p.theta)):p.theta=p.theta>(C+N)/2?Math.max(C,p.theta):Math.min(N,p.theta)),p.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,p.phi)),p.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(F,e.dampingFactor):e.target.add(F),e.target.sub(e.cursor),e.target.clampLength(e.minTargetRadius,e.maxTargetRadius),e.target.add(e.cursor);let ne=!1;if(e.zoomToCursor&&K||e.object.isOrthographicCamera)p.radius=a(p.radius);else{const z=p.radius;p.radius=a(p.radius*E),ne=z!=p.radius}if(t.setFromSpherical(p),t.applyQuaternion(i),Se.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(T.theta*=1-e.dampingFactor,T.phi*=1-e.dampingFactor,F.multiplyScalar(1-e.dampingFactor)):(T.set(0,0,0),F.set(0,0,0)),e.zoomToCursor&&K){let z=null;if(e.object.isPerspectiveCamera){const ae=t.length();z=a(ae*E);const le=ae-z;e.object.position.addScaledVector(ee,le),e.object.updateMatrixWorld(),ne=!!le}else if(e.object.isOrthographicCamera){const ae=new b(y.x,y.y,0);ae.unproject(e.object);const le=e.object.zoom;e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/E)),e.object.updateProjectionMatrix(),ne=le!==e.object.zoom;const Ce=new b(y.x,y.y,0);Ce.unproject(e.object),e.object.position.sub(Ce).add(ae),e.object.updateMatrixWorld(),z=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;z!==null&&(this.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(z).add(e.object.position):(de.origin.copy(e.object.position),de.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(de.direction))<lt?j.lookAt(e.target):(ve.setFromNormalAndCoplanarPoint(e.object.up,e.target),de.intersectPlane(ve,e.target))))}else if(e.object.isOrthographicCamera){const z=e.object.zoom;e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/E)),z!==e.object.zoom&&(e.object.updateProjectionMatrix(),ne=!0)}return E=1,K=!1,ne||m.distanceToSquared(e.object.position)>V||8*(1-g.dot(e.object.quaternion))>V||H.distanceToSquared(e.target)>V?(e.dispatchEvent(Fe),m.copy(e.object.position),g.copy(e.object.quaternion),H.copy(e.target),!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",Re),e.domElement.removeEventListener("pointerdown",Ae),e.domElement.removeEventListener("pointercancel",oe),e.domElement.removeEventListener("wheel",Le),e.domElement.removeEventListener("pointermove",ye),e.domElement.removeEventListener("pointerup",oe),e.domElement.getRootNode().removeEventListener("keydown",De,{capture:!0}),e._domElementKeyEvents!==null&&(e._domElementKeyEvents.removeEventListener("keydown",ge),e._domElementKeyEvents=null)};const e=this,c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=c.NONE;const V=1e-6,p=new ze,T=new ze;let E=1;const F=new b,I=new O,P=new O,Y=new O,R=new O,x=new O,A=new O,L=new O,v=new O,k=new O,ee=new b,y=new O;let K=!1;const f=[],Z={};let U=!1;function S(t){return t!==null?2*Math.PI/60*e.autoRotateSpeed*t:2*Math.PI/60/60*e.autoRotateSpeed}function D(t){const o=Math.abs(t*.01);return Math.pow(.95,e.zoomSpeed*o)}function M(t){T.theta-=t}function X(t){T.phi-=t}const ie=function(){const t=new b;return function(i,m){t.setFromMatrixColumn(m,0),t.multiplyScalar(-i),F.add(t)}}(),u=function(){const t=new b;return function(i,m){e.screenSpacePanning===!0?t.setFromMatrixColumn(m,1):(t.setFromMatrixColumn(m,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(i),F.add(t)}}(),n=function(){const t=new b;return function(i,m){const g=e.domElement;if(e.object.isPerspectiveCamera){const H=e.object.position;t.copy(H).sub(e.target);let w=t.length();w*=Math.tan(e.object.fov/2*Math.PI/180),ie(2*i*w/g.clientHeight,e.object.matrix),u(2*m*w/g.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(ie(i*(e.object.right-e.object.left)/e.object.zoom/g.clientWidth,e.object.matrix),u(m*(e.object.top-e.object.bottom)/e.object.zoom/g.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function r(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?E/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function s(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?E*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function l(t,o){if(!e.zoomToCursor)return;K=!0;const i=e.domElement.getBoundingClientRect(),m=t-i.left,g=o-i.top,H=i.width,w=i.height;y.x=m/H*2-1,y.y=-(g/w)*2+1,ee.set(y.x,y.y,1).unproject(e.object).sub(e.object.position).normalize()}function a(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function _(t){I.set(t.clientX,t.clientY)}function B(t){l(t.clientX,t.clientX),L.set(t.clientX,t.clientY)}function W(t){R.set(t.clientX,t.clientY)}function q(t){P.set(t.clientX,t.clientY),Y.subVectors(P,I).multiplyScalar(e.rotateSpeed);const o=e.domElement;M(2*Math.PI*Y.x/o.clientHeight),X(2*Math.PI*Y.y/o.clientHeight),I.copy(P),e.update()}function se(t){v.set(t.clientX,t.clientY),k.subVectors(v,L),k.y>0?r(D(k.y)):k.y<0&&s(D(k.y)),L.copy(v),e.update()}function me(t){x.set(t.clientX,t.clientY),A.subVectors(x,R).multiplyScalar(e.panSpeed),n(A.x,A.y),R.copy(x),e.update()}function pe(t){l(t.clientX,t.clientY),t.deltaY<0?s(D(t.deltaY)):t.deltaY>0&&r(D(t.deltaY)),e.update()}function fe(t){let o=!1;switch(t.code){case e.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?X(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):n(0,e.keyPanSpeed),o=!0;break;case e.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?X(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):n(0,-e.keyPanSpeed),o=!0;break;case e.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?M(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):n(e.keyPanSpeed,0),o=!0;break;case e.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?M(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):n(-e.keyPanSpeed,0),o=!0;break}o&&(t.preventDefault(),e.update())}function te(t){if(f.length===1)I.set(t.pageX,t.pageY);else{const o=Q(t),i=.5*(t.pageX+o.x),m=.5*(t.pageY+o.y);I.set(i,m)}}function re(t){if(f.length===1)R.set(t.pageX,t.pageY);else{const o=Q(t),i=.5*(t.pageX+o.x),m=.5*(t.pageY+o.y);R.set(i,m)}}function ce(t){const o=Q(t),i=t.pageX-o.x,m=t.pageY-o.y,g=Math.sqrt(i*i+m*m);L.set(0,g)}function he(t){e.enableZoom&&ce(t),e.enablePan&&re(t)}function Be(t){e.enableZoom&&ce(t),e.enableRotate&&te(t)}function Me(t){if(f.length==1)P.set(t.pageX,t.pageY);else{const i=Q(t),m=.5*(t.pageX+i.x),g=.5*(t.pageY+i.y);P.set(m,g)}Y.subVectors(P,I).multiplyScalar(e.rotateSpeed);const o=e.domElement;M(2*Math.PI*Y.x/o.clientHeight),X(2*Math.PI*Y.y/o.clientHeight),I.copy(P)}function Oe(t){if(f.length===1)x.set(t.pageX,t.pageY);else{const o=Q(t),i=.5*(t.pageX+o.x),m=.5*(t.pageY+o.y);x.set(i,m)}A.subVectors(x,R).multiplyScalar(e.panSpeed),n(A.x,A.y),R.copy(x)}function je(t){const o=Q(t),i=t.pageX-o.x,m=t.pageY-o.y,g=Math.sqrt(i*i+m*m);v.set(0,g),k.set(0,Math.pow(v.y/L.y,e.zoomSpeed)),r(k.y),L.copy(v);const H=(t.pageX+o.x)*.5,w=(t.pageY+o.y)*.5;l(H,w)}function He(t){e.enableZoom&&je(t),e.enablePan&&Oe(t)}function Ke(t){e.enableZoom&&je(t),e.enableRotate&&Me(t)}function Ae(t){e.enabled!==!1&&(f.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",ye),e.domElement.addEventListener("pointerup",oe)),!qe(t)&&(Ge(t),t.pointerType==="touch"?Ie(t):Ze(t)))}function ye(t){e.enabled!==!1&&(t.pointerType==="touch"?We(t):Ue(t))}function oe(t){switch(Ve(t),f.length){case 0:e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",ye),e.domElement.removeEventListener("pointerup",oe),e.dispatchEvent(Ye),d=c.NONE;break;case 1:const o=f[0],i=Z[o];Ie({pointerId:o,pageX:i.x,pageY:i.y});break}}function Ze(t){let o;switch(t.button){case 0:o=e.mouseButtons.LEFT;break;case 1:o=e.mouseButtons.MIDDLE;break;case 2:o=e.mouseButtons.RIGHT;break;default:o=-1}switch(o){case J.DOLLY:if(e.enableZoom===!1)return;B(t),d=c.DOLLY;break;case J.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;W(t),d=c.PAN}else{if(e.enableRotate===!1)return;_(t),d=c.ROTATE}break;case J.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;_(t),d=c.ROTATE}else{if(e.enablePan===!1)return;W(t),d=c.PAN}break;default:d=c.NONE}d!==c.NONE&&e.dispatchEvent(Pe)}function Ue(t){switch(d){case c.ROTATE:if(e.enableRotate===!1)return;q(t);break;case c.DOLLY:if(e.enableZoom===!1)return;se(t);break;case c.PAN:if(e.enablePan===!1)return;me(t);break}}function Le(t){e.enabled===!1||e.enableZoom===!1||d!==c.NONE||(t.preventDefault(),e.dispatchEvent(Pe),pe(Xe(t)),e.dispatchEvent(Ye))}function Xe(t){const o=t.deltaMode,i={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(o){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return t.ctrlKey&&!U&&(i.deltaY*=10),i}function De(t){t.key==="Control"&&(U=!0,e.domElement.getRootNode().addEventListener("keyup",_e,{passive:!0,capture:!0}))}function _e(t){t.key==="Control"&&(U=!1,e.domElement.getRootNode().removeEventListener("keyup",_e,{passive:!0,capture:!0}))}function ge(t){e.enabled===!1||e.enablePan===!1||fe(t)}function Ie(t){switch(ke(t),f.length){case 1:switch(e.touches.ONE){case $.ROTATE:if(e.enableRotate===!1)return;te(t),d=c.TOUCH_ROTATE;break;case $.PAN:if(e.enablePan===!1)return;re(t),d=c.TOUCH_PAN;break;default:d=c.NONE}break;case 2:switch(e.touches.TWO){case $.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;he(t),d=c.TOUCH_DOLLY_PAN;break;case $.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Be(t),d=c.TOUCH_DOLLY_ROTATE;break;default:d=c.NONE}break;default:d=c.NONE}d!==c.NONE&&e.dispatchEvent(Pe)}function We(t){switch(ke(t),d){case c.TOUCH_ROTATE:if(e.enableRotate===!1)return;Me(t),e.update();break;case c.TOUCH_PAN:if(e.enablePan===!1)return;Oe(t),e.update();break;case c.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;He(t),e.update();break;case c.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Ke(t),e.update();break;default:d=c.NONE}}function Re(t){e.enabled!==!1&&t.preventDefault()}function Ge(t){f.push(t.pointerId)}function Ve(t){delete Z[t.pointerId];for(let o=0;o<f.length;o++)if(f[o]==t.pointerId){f.splice(o,1);return}}function qe(t){for(let o=0;o<f.length;o++)if(f[o]==t.pointerId)return!0;return!1}function ke(t){let o=Z[t.pointerId];o===void 0&&(o=new O,Z[t.pointerId]=o),o.set(t.pageX,t.pageY)}function Q(t){const o=t.pointerId===f[0]?f[1]:f[0];return Z[o]}e.domElement.addEventListener("contextmenu",Re),e.domElement.addEventListener("pointerdown",Ae),e.domElement.addEventListener("pointercancel",oe),e.domElement.addEventListener("wheel",Le,{passive:!1}),e.domElement.getRootNode().addEventListener("keydown",De,{passive:!0,capture:!0}),this.update()}}function dt(){const xe=document.querySelector("#three-canvas"),j=new ot({canvas:xe,antialias:!0});j.setSize(window.innerWidth-50,window.innerHeight-350);const h=new nt,e=new at(75,window.innerWidth/window.innerHeight,.1,1e3);e.position.y=1.5,e.position.z=4,h.add(e);const c=new it("white",.5);h.add(c);const d=new st("white",1);d.position.x=1,d.position.z=2,h.add(d);const V=new ut(e,j.domElement);V.enableDamping=!0,new rt(.1,.1,.1),document.getElementById("object-count");const p=document.getElementById("generate-objects-button"),T=document.getElementById("generate-objects-clearButton"),E=document.getElementById("fx_function"),F=document.getElementById("x_start"),I=document.getElementById("x_end"),P=document.getElementById("fy_function"),Y=document.getElementById("y_start"),R=document.getElementById("y_end"),x=document.getElementById("dot_x"),A=document.getElementById("dot_y"),L=document.getElementById("dot_learning_rate"),v=document.getElementById("generate-dot-button"),k=document.getElementById("remove-dot-clearButton");function ee(u,n,r=1e-4){return(u(n+r)-u(n))/r}function y(u){return new Function("x","return "+u)}function K(){const u=[];h.children.forEach(n=>{n instanceof G&&u.push(n)}),u.forEach(n=>{h.remove(n)})}function f(){const u=[];h.children.forEach(n=>{n instanceof G&&n.geometry instanceof Te&&u.push(n)}),u.forEach(n=>{h.remove(n)})}T.addEventListener("click",K),k.addEventListener("click",f),p.addEventListener("click",()=>{console.log(E.value),K();let u=y(E.value),n=y(P.value),r=.1,s=.1;for(let l=parseFloat(F.value);l<parseFloat(I.value);l+=r)for(let a=parseFloat(Y.value);a<parseFloat(R.value);a+=s){console.log(l);const _=new be,B=new Float32Array([l,u(l)+n(a),a,l+r/2,u(l+r/2)+n(a+s/2),a+s/2,l+r,u(l+r)+n(a),a]);_.setAttribute("position",new Ee(B,3));const W=new ue({color:16711680,side:we}),q=new G(_,W);h.add(q);const se=new be,me=new Float32Array([l+r,u(l+r)+n(a),a,l+r/2,u(l+r/2)+n(a+s/2),a+s/2,l+r,u(l+r)+n(a+s),a+s]);se.setAttribute("position",new Ee(me,3));const pe=new ue({color:65280,side:we}),fe=new G(se,pe);h.add(fe);const te=new be,re=new Float32Array([l+r,u(l+r)+n(a+s),a+s,l+r/2,u(l+r/2)+n(a+s/2),a+s/2,l,u(l)+n(a+s),a+s]);te.setAttribute("position",new Ee(re,3));const ce=new ue({color:255,side:we}),he=new G(te,ce);h.add(he)}}),v.addEventListener("click",()=>{console.log("현재 학습률 : "+L.value),console.log(x.value),console.log(A.value);const u=new Te(.1,32,32),n=new ue({color:16711680}),r=new G(u,n);r.position.x=x.value,r.position.z=A.value;let s=y(E.value),l=y(P.value);r.position.y=s(x.value)+l(A.value),h.add(r)});const Z=new ct;let U=0,S=[],D=[],M=[];function X(){const u=Z.getElapsedTime();let n=(u-U)/10,r=1-n;for(let s=0;s<S.length;s++)S.at(s).position.x=parseFloat(D[s][0])*r+parseFloat(M[s][0])*n,S.at(s).position.y=parseFloat(D[s][1])*r+parseFloat(M[s][1])*n,S.at(s).position.z=parseFloat(D[s][2])*r+parseFloat(M[s][2])*n;if(u-U>=10){console.log("10초가 경과했습니다. dot 갱신을 진행합니다.");let s=y(E.value),l=y(P.value);S=[],h.children.forEach(a=>{a instanceof G&&a.geometry instanceof Te&&S.push(a)}),D=[],M=[],S.forEach(a=>{let _=[];_.push(a.position.x),_.push(a.position.y),_.push(a.position.z),D.push(_);let B=[],W=parseFloat(a.position.x)-L.value*ee(s,parseFloat(a.position.x)),q=parseFloat(a.position.z)-L.value*ee(l,parseFloat(a.position.z));B.push(W),B.push(s(W)+l(q)),B.push(q),M.push(B)}),U=u}V.update(),j.render(h,e),j.setAnimationLoop(X)}function ie(){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),j.setSize(window.innerWidth,window.innerHeight),j.render(h,e)}window.addEventListener("resize",ie),X()}dt();

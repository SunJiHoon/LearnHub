import{W as ue,S as le,P as me,O as I,M as pe,a as ye,b as X,F as ve,B as xe,c as fe,d as P,e as he,f as Me}from"./three.module-CixzsxP4.js";import{O as ge}from"./OrbitControls-DmaEd0dv.js";document.addEventListener("DOMContentLoaded",()=>{const Y=document.getElementById("three-canvas"),S=document.getElementById("canvas-container"),W=document.getElementById("f"),j=document.getElementById("xmin"),V=document.getElementById("xmax"),$=document.getElementById("ymin"),H=document.getElementById("ymax"),q=document.getElementById("x0"),J=document.getElementById("y0"),K=document.getElementById("eta"),Q=document.getElementById("btn-plot"),T=document.getElementById("btn-add-point"),U=document.getElementById("btn-clear-point"),C=document.getElementById("vsh"),R=document.getElementById("fsh");let i=()=>0;function Z(e,t){return(i(e+1e-4,t)-i(e,t))/1e-4}function ee(e,t){return(i(e,t+1e-4)-i(e,t))/1e-4}const l=new ue({canvas:Y,antialias:!0}),g=new le,r=new me(75,1,.1,1e3);r.position.x=2,r.position.y=2,r.position.z=4;function L(){const{width:e,height:t}=S.getBoundingClientRect();r.aspect=e/t,r.updateProjectionMatrix(),l.setSize(e,t)}function k(){l.setPixelRatio(devicePixelRatio)}L(),k(),g.add(r);const N=new ge(r,l.domElement);N.enableDamping=!0,new ResizeObserver(()=>L()).observe(S),function e(){const t=matchMedia(`(resolution: ${devicePixelRatio}dppx)`);t.addEventListener("change",function n(){t.removeEventListener("change",n),k(),e()})}();const y=new I,v=new I,x=new I;y.applyMatrix4(new pe(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1)),g.add(y),y.add(v),y.add(x);const te=new ye(.1,32,32),b={value:0},E={value:1},ne=new X({vertexShader:C.textContent,fragmentShader:R.textContent,uniforms:{valueMin:b,valueMax:E,opacity:{value:1}},side:ve}),oe=new X({vertexShader:C.textContent,fragmentShader:R.textContent,uniforms:{valueMin:b,valueMax:E,opacity:{value:.25}},side:xe,transparent:!0}),ae=new fe({color:16711680});function ie(){const e=q.valueAsNumber,t=J.valueAsNumber,n=new P(te,ae);n.position.x=e,n.position.y=t,n.position.z=i(e,t),x.add(n)}function z(){x.clear()}function F(){v.clear(),z(),i=new Function("x","y",`return ${W.value}`);const e=.1,t=.1,n=Math.floor(j.valueAsNumber/e)*e,m=Math.ceil(V.valueAsNumber/e)*e,p=Math.floor($.valueAsNumber/t)*t,se=Math.ceil(H.valueAsNumber/t)*t,w=(se-p)/t,B=(m-n)/e,D=[...Array(w+1)].map((a,o)=>[...Array(B+1)].map((u,d)=>i(n+d*e,p+o*t))),_=[...Array(w)].map((a,o)=>[...Array(B)].map((u,d)=>i(n+(d+.5)*e,p+(o+.5)*t))),G=[...D.flat(1),..._.flat(1)],de=G.reduce((a,o)=>Math.min(a,o),1/0),ce=G.reduce((a,o)=>Math.max(a,o),-1/0);b.value=de,E.value=ce;function s(a,o){c.push(n+a*e,p+o*t,D[o][a])}const c=[];for(let a=0;a<w;a++)for(let o=0;o<B;o++){const u=o,d=a,f=o+1,h=a+1,M=[n+(o+.5)*e,p+(a+.5)*t,_[a][o]];s(u,d),s(f,d),c.push(...M),s(f,d),s(f,h),c.push(...M),s(f,h),s(u,h),c.push(...M),s(u,h),s(u,d),c.push(...M)}const A=new he;A.setAttribute("position",new Me(c,3)),v.add(new P(A,ne)),v.add(new P(A,oe))}Q.addEventListener("click",()=>F()),T.addEventListener("click",()=>ie()),U.addEventListener("click",()=>z()),F();let O=Date.now();function re(){if(Date.now()>=O){O+=1e3;for(const e of x.children){const t=K.valueAsNumber,n=e.position.x,m=e.position.y;e.position.x=n-t*Z(n,m),e.position.y=m-t*ee(n,m),e.position.z=i(e.position.x,e.position.y)}}N.update(),l.render(g,r)}l.setAnimationLoop(re)});
